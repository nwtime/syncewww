<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=content-security-policy content="default-src 'self'; connect-src 'self' https://www.clarity.ms https://j.clarity.ms https://www.google-analytics.com https://t.clarity.ms; child-src 'self'; font-src 'self' https://fonts.gstatic.com; form-action 'self'; frame-src 'self' https://secure.lglforms.com; img-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google-analytics.com https://www.googletagmanager.com https://www.google.com https://clients1.google.com https://www.googleapis.com https://cse.google.com https://encrypted-tbn0.gstatic.com https://encrypted-tbn3.gstatic.com https://c.clarity.ms https://c.bing.com http://clients1.google.com; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cse.google.com https://www.google.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google-analytics.com https://www.googletagmanager.com https://cse.google.com https://www.google.com https://www.clarity.ms http://cse.google.com https://secure.lglforms.com;"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=canonical href=https://sync-e.nwtime.org/synced/documentation/><meta property="og:title" content="Documentation"><meta property="og:description" content="Documentation for Renesas synced."><meta property="og:type" content="article"><meta property="og:url" content="https://sync-e.nwtime.org/synced/documentation/"><meta property="og:image" content="https://sync-e.nwtime.org/images/featured.webp"><meta property="article:section" content="synced"><meta property="og:site_name" content="SyncE Projects"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sync-e.nwtime.org/images/featured.webp"><meta name=twitter:title content="Documentation"><meta name=twitter:description content="Documentation for Renesas synced."><script>window.onload=demo;function demo(){document.getElementById("gsc-i-id1").setAttribute("placeholder","Search...")}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GX2RY34XWL"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-GX2RY34XWL',{anonymize_ip:!0})</script><script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","j1ut0n0mtn")</script><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel=stylesheet><title>Documentation</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for Renesas synced."><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=/scss/nwtime.min.6518b367ab9894fc6df3875df85f4dc1.css media=screen></head><body><nav class="navbar navbar-expand-lg navbar-light"><div class=container-fluid><div><a class=navbar-brand href=https://www.nwtime.org><img height=80 width=80 src=https://sync-e.nwtime.org/images/logo.png alt></a>
<a class=navbar-brand style=color:#1a79c0!important;font-size:18px;font-weight:700;margin-left:20px href=https://sync-e.nwtime.org/>SyncE Projects</a></div><div><button class="btn btn-primary btn-lg" type=button><a class="nav-item btn btn-primary btn-lg" style=text-decoration:none;text-transform:uppercase href=/donate/>Support<br>SyncE!</a></button></div><script async src="https://cse.google.com/cse.js?cx=7474c4c5ca53f79ef"></script><div class=gcse-search></ul></div></nav><div class=header-border></div><section class="section pt-0 pb-auto"><div class=container><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://sync-e.nwtime.org/synced/>Renesas synced</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://sync-e.nwtime.org/synced/documentation/>Documentation</a></li></ol></nav><h4 id=table-of-contents>Table of Contents</h4><ul><li><a href=/synced/documentation/#hardware>Hardware</a></li><li><a href=/synced/documentation/#software>Software</a></li><li><a href=/synced/documentation/#configuration>Configuration</a></li><li><a href=/synced/documentation/#management-api>Management API</a></li><li><a href=/synced/documentation/#event-callback-functions>Event Callback Functions</a></li><li><a href=/synced/documentation/#acronyms>Acronyms</a></li></ul><hr><h4 id=hardware>Hardware</h4><figure class=figure><img src=/synced/figure1.jpg class="figure-img img-fluid"><figcaption class=figure-caption>Figure 1. Hardware inter-connection between SyncE ports, external clocks, inputs, outputs, the DPLL device, and the CPU running <code>synced</code> application.</figcaption></figure><p>One or more external multiplexers can be used to connect multiple SyncE ports to a clock.</p><p>The multiplexers can be both single-output or dual-output:</p><figure class=figure><img src=/synced/mux.jpg class="figure-img img-fluid"></figcaption></figure><p>Those ports connected to external multiplexers, which are not associated to a clock, are called SyncE monitoring ports. The transition of a SyncE port from monitoring state to active state can be done automatically using the event callback functions and the management APIs, or can be initiated by the user.</p><figure class=figure><img src=/synced/figure2.jpg class="figure-img img-fluid"><figcaption class=figure-caption>Figure 2. Software block diagram and the connection with the DPLL device..</figcaption></figure><hr><h4 id=software>Software</h4><p><code>synced</code> application runs on CPU and interacts with the DPLL device as follows:</p><ul><li>Read the DPLL status (Locked, Holdover, etc.).</li><li>Read the selected clock index to determine the current QL.</li><li>Read the device reference monitors status to notify the user when the physical clocks qualification fails.</li><li>Set the selected clock, or write a clock priority table into the DPLL device.</li></ul><p><em>Device APIs</em> module implements the hardware abstraction layer.</p><p>The architecture is modular, and each software module performs simple tasks:</p><ul><li>The <em>ESMC stack</em> notifies the <em>Selector</em> when a SyncE port Quality Level has changed.</li><li>The <em>Selector</em> sets the clock priority table into the DPLL device.</li><li>SyncE DPLL monitor reads the DPLL and clock status and sets the current QL into the ESMC stack.</li><li><em>PCM interface</em> enables the communication with an external PTP Clock Manager application if needed. The purpose of this interface is to provide the current clock category.</li><li>The management interface enables the communication with an external CLI client <code>SYNCED_CLI</code> which is included in the open-source code. <code>SYNCED_CLI</code> implements all management APIs.</li></ul><hr><h4 id=configuration>Configuration</h4><p>The configuration file has two sections:</p><p><strong>Global</strong>:</p><ul><li>ESMC network option</li><li>No QL mode enable</li><li>SyncE port forced QL enable</li><li>LO QL</li><li>LO Priority</li><li>Device config file name</li><li>SyncE DPLL index</li><li>Holdover QL</li><li>Holdover timer in seconds</li><li>Hold-off timer in milliseconds</li><li>Wait-to-restore timer in seconds</li><li>PCM interface enable, IP address and port number</li><li>Management interface enable, IP address and port number</li><li>Syslog enable (configurable message level)</li><li>Stdout enable (configurable message level)</li></ul><p><strong>Per port</strong>:</p><ul><li>[name] (ex: [eth0])</li><li>Clock index</li><li>Priority</li><li>TX enable</li><li>RX enable</li><li>TX bundle number</li><li>Initial QL</li></ul><table><thead><tr><th>Port type</th><th style=text-align:center>[name]</th><th style=text-align:center>Clock index</th><th style=text-align:center>Priority</th><th style=text-align:center>TX enable</th><th style=text-align:center>RX enable</th><th style=text-align:center>TX bundle number</th><th style=text-align:center>Initial QL</th></tr></thead><tbody><tr><td>Active SyncE clock</td><td style=text-align:center>m</td><td style=text-align:center>m</td><td style=text-align:center>m</td><td style=text-align:center>opt</td><td style=text-align:center>1</td><td style=text-align:center>opt</td><td style=text-align:center>opt/n</td></tr><tr><td>External clock</td><td style=text-align:center>m</td><td style=text-align:center>m</td><td style=text-align:center>m</td><td style=text-align:center>n</td><td style=text-align:center>n</td><td style=text-align:center>N</td><td style=text-align:center>opt/n</td></tr><tr><td>SyncE monitoring</td><td style=text-align:center>m</td><td style=text-align:center>n</td><td style=text-align:center>m</td><td style=text-align:center>opt</td><td style=text-align:center>1</td><td style=text-align:center>opt</td><td style=text-align:center>opt/n</td></tr><tr><td>TX only</td><td style=text-align:center>m</td><td style=text-align:center>n</td><td style=text-align:center>n</td><td style=text-align:center>m</td><td style=text-align:center>n</td><td style=text-align:center>opt</td><td style=text-align:center>n</td></tr></tbody></table><p><strong>m</strong> = mandatory, <strong>n</strong> = must not be defined, <strong>opt</strong> = optional, default value applies if missing, <strong>1</strong> = must be set to 1</p><hr><h4 id=management-api>Management API</h4><p><code>synced</code> provides a set of management APIs to get information and set parameters. These APIs can be either called directly if the source code is integrated in other projects, or they can be called by other applications via <em>Management Interface</em>. This interface can be enabled and configured in the configuration file.</p><p>The APIs return one of the following response codes:</p><table><thead><tr><th style=text-align:center>Response code</th><th>Response</th><th>Details</th></tr></thead><tbody><tr><td style=text-align:center>0</td><td>Ok</td><td>The command finished successfully.</td></tr><tr><td style=text-align:center>1</td><td>Invalid</td><td>One or more input arguments are invalid.</td></tr><tr><td style=text-align:center>2</td><td>Failed</td><td>Command failed. Ex: port name cannot be found.</td></tr><tr><td style=text-align:center>3</td><td>Not Supported</td><td>The command is not supported in current operation mode.</td></tr></tbody></table><ol><li><p>Get a list of sync information structures, one for each port:</p><ul><li>Port name</li><li>Port sync type (Active SyncE, External, Monitoring or TX only)</li><li>Type-specific information:</li></ul><table><thead><tr><th>Information</th><th style=text-align:center>Active SyncE</th><th style=text-align:center>External</th><th style=text-align:center>Monitoring</th><th style=text-align:center>TX only</th></tr></thead><tbody><tr><td>priority</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>current QL</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>sync state</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>TX bundle number</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center>x</td><td style=text-align:center>x</td></tr><tr><td>clock index</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td>hoff/wtr remaining time [ms]</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>number of hops</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>rank</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>sync clock state</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td>clock reference monitor status</td><td style=text-align:center>x</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center></td></tr><tr><td>RX timeout flag</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center>x</td><td style=text-align:center></td></tr><tr><td>port link-down flag</td><td style=text-align:center>x</td><td style=text-align:center></td><td style=text-align:center>x</td><td style=text-align:center>x</td></tr></tbody></table></li><li><p>Get a sync information structure for a specific port. The application provides the information for the specified port name.</p></li><li><p>Get current status:</p><ul><li>Current QL</li><li>Selected port name</li><li>Selected clock index</li><li>SyncE DPLL state</li><li>Holdover remaining time in milliseconds</li></ul></li><li><p>Set forced QL per port</p></li><li><p>Clear forced QL per port</p></li><li><p>Clear holdover timer</p></li><li><p>Clear SyncE clock wait-to-restore timer per port</p></li><li><p>Assign a new SyncE port to a clock index</p></li><li><p>Set priority per port</p></li></ol><hr><h4 id=event-callback-functions>Event Callback Functions</h4><p>The purpose of the callback functions is to notify the user when an event occurs. The implementation is on user side; however, <code>synced</code> contains template code for each callback and examples on how to control the external multiplexers.</p><ol><li>Current QL</li><li>Sync port current QL</li><li>SyncE DPLL current state (Locked, Holdover, etc)</li><li>Sync port current clock state (Qualified, Unqualified)</li><li>Sync port current state (Normal, Forced, Wait-to-restore, Hold-off)</li><li>Alarms:<ul><li>Timing loop detected</li><li>Invalid QL received at port</li></ul></li><li>PCM interface status</li></ol><hr><h4 id=acronyms>Acronyms</h4><table><thead><tr><th>Acronym</th><th>Definition</th></tr></thead><tbody><tr><td>DPLL</td><td>Digital Phase Lock Loop</td></tr><tr><td>DNU</td><td>Do-not-use</td></tr><tr><td>ESMC</td><td>Ethernet Synchronization Messaging Channel</td></tr><tr><td>ITU-T</td><td>International Telecommunication Union – Telecommunication Standardization Sector</td></tr><tr><td>LO</td><td>Local Oscillator</td></tr><tr><td>MUX</td><td>Multiplexer</td></tr><tr><td>PCM</td><td>PTP Clock Manager</td></tr><tr><td>PTP</td><td>Precision Time Protocol</td></tr><tr><td>PTP4L</td><td>Precision Time Protocol for Linux</td></tr><tr><td>QL</td><td>Quality Level</td></tr><tr><td>TLV</td><td>Type-Length-Value</td></tr></tbody></table><hr><br><div style=text-align:center><button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=https://github.com/renesas/synced>Source Code <img src=/images/icons/github.svg></img></a></button>
<button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=https://github.com/renesas/linux-ptp-driver-package>Download RSMU driver <img src=/images/icons/download.svg></img></a></button>
<button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=https://github.com/renesas/synced/blob/main/README.md>README <img src=/images/icons/book.svg></img></a></button>
<button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=/synced/documentation/>Documentation <img src=/images/icons/folder.svg></img></a></button></div><br></div></section><nav class="site-footer navbar navbar-expand-sm mt-auto"><div class=container><ul class=navbar-nav><li class=nav-item title="Mailing lists" aria-label="Mailing lists"><a class=nav-link target=_blank rel="noopener noreferrer" href=https://lists.nwtime.org><img src=/images/icons/envelope.svg width=20 height=20></img></a></li></ul><ul class="mx-auto pt-3"><p>&copy; 2023 <a class="navbar-text text-white" href=https://www.nwtime.org>Network Time Foundation</a></p></ul></div></nav></body></html>